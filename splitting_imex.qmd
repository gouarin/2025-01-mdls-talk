# A dual Splitting/IMEX strategy for stiff PDEs

## A dual Splitting/IMEX strategy for stiff PDEs {.fs-4}

:::{.row .fs-6}
::::{.col-7 .align-self-center}
- A strategy has been designed (PhD M. Duarte) relying on time-adaptive operator splitting with dynamically adapted mesh (multiresolution) with error control:
  - optimal computational cost and parallelization properties when large splitting time steps compared to the smallest time scale can be taken without impairing precision
- We aim at resolving stiff PDEs with samurai and ponio (time integrators) libraries with the same computation favorable properties:
  - the same computational properties (local implicitation of the source term - allowing for very stiff source with local time integration in space)
  - explicit diffusion integration without von Neumann stability limit (ROCK)
  - high-order in space and time integration of convection, including shocks
  - strong acceleration through adaptation in space and time
- Stumbling block: what to do when reaction and diffusion coupled to the smallest time scale (complex chemistry)
::::

::::{.col .align-self-center}
<div>
<video data-autoplay loop="true" src="videos/ignition_Re1000.mov" />
</div>
![](figures/splitting_time_steps.jpg)
::::
:::

## A dual Splitting/IMEX strategy for stiff PDEs {.fs-4}

:::{.row }
::::{.col-8 .align-self-center}
- Keep reaction and diffusion coupled (IMEX)!
- No splitting time step limitation due to the coupling at small scale (complex chemistry and detailed transport in flames for example)
- Relying on the PIROCK strategy of G. Vilmart and A. Abdulle.
- Adaptation in space and time with error control
- Project with CEA on hydrogen risk - DNS combustion with detailed transport and CChem
::::

::::{.col .text-center}
![](figures/hpc@maths.png){width=50%}
![](figures/logo.png){width=50%}
![](figures/logo-cea.webp){width=50%}
::::
:::

## A dual Splitting/IMEX strategy for stiff PDEs {.fs-4}

:::{.row .fs-5 }
::::{.col-6 .align-self-center}
Ignition and Combustion (Verwer & Hundsdorfer)

Specific for RKC methods and ROCK

$$
u_t = d \Delta u + \frac{R}{\alpha \delta} (1 + \alpha - u) e^{\delta( 1 - 1/u )} \quad \text{in } [0,1]\times[0,1]
$$

![](figures/combustion2d.png){width=60% fig-align="center"}
::::

::::{.col .text-center}
![](figures/combustion.svg){width=80%}
::::
:::

## A dual Splitting/IMEX strategy for stiff PDEs {.fs-4}

:::{.row .fs-5 }
::::{.col-6 .align-self-center}
Ignition and Combustion (Verwer & Hundsdorfer)

Specific for RKC methods and ROCK

$$
u_t = d \Delta u + \frac{R}{\alpha \delta} (1 + \alpha - u) e^{\delta( 1 - 1/u )} \quad \text{in } [0,1]\times[0,1]
$$

![](figures/combustion2d.png){width=60% fig-align="center"}
::::

::::{.col .text-center}
:::::{.fs-6 .fragment}
|                                     | PIROCK    | ROCK2  | ROCK4  |
|-------------------------------------|-----------|--------|--------|
| Tolerance used                      | 1e-5      | 1e-6   | 1e-5   |
| L2 norm of error                    | 1.84e-4   | 2.27e-4| 2.69e-4|
| Elapsed time (s)                    | 7.97      | 1.90   | 0.42   |
| Nb. time steps                      | 889       | 157    | 57     |
| Nb. time steps rejected             | 0         | 0      | 0      |
| Nb. function evaluation             | -         | 6367   | 1734   |
| Nb. function evaluation (diffusion) | 8304      | -      | -      |
| Nb. function evaluation (reaction)  | 360067655 | -      | -      |

between $t=0.29$ and $t=0.32$.
:::::
:::::{.fs-6 .fragment}
IMEX reasonable overhead compared to fully explicit methods (ROCK2 - ROCK4) even in this very difficult configuration

<ul class="list-unstyled text-center">
  <li class="my-1">Error control</li>
  <li class="my-1">Good BC treatment</li>
  <li class="my-1">No splitting errors</li>
</ul>

:::::
::::
:::

## A dual Splitting/IMEX strategy for stiff PDEs {.fs-4}

:::{.row .fs-6 }

::::{.col-6 .align-self-center }
Belousov-Zhabotinsky (very stiff source - 3 eq)
$$
\left\{
\begin{aligned}
\partial_t a - D_a \, \Delta a &= \frac{1}{\mu} ( -qa - ab
+
fc) \\
\partial_t b - D_b \, \Delta b &= \frac{1}{\varepsilon} (
qa
- ab + b\,(1-b)) \\
\partial_t c - D_c \, \Delta c &= b - c
\end{aligned}
\right.
$$

- Error to the reference quasi-exact solution is second order in time but not of the same origin (splitting error vs. IMEX error) - but still error control
- Larger time step can be taken with IMEX while keeping a proper solution (no disastrous splitting errors - wrong wave speed)
- When optimal large splitting time step is taken, IMEX as efficient as splitting, whereas it is advantageous for smaller time steps as well as larger time steps
- No boundary condition problems
- Same computational good properties
::::

::::{.col-6 .text-center}
![](figures/bz_b_t=0.png){width="48%"}
![](figures/bz_b_t=1.png){width="48%"}
<br>
![](figures/bz_b_t=2.png){width="48%"}
::::
:::

## A dual Splitting/IMEX strategy for stiff PDEs {.fs-4}

:::{.row .fs-6 }

::::{.col-6 .align-self-center }
Belousov-Zhabotinsky (very stiff source - 3 eq)
$$
\left\{
\begin{aligned}
\partial_t a - D_a \, \Delta a &= \frac{1}{\mu} ( -qa - ab
+
fc) \\
\partial_t b - D_b \, \Delta b &= \frac{1}{\varepsilon} (
qa
- ab + b\,(1-b)) \\
\partial_t c - D_c \, \Delta c &= b - c
\end{aligned}
\right.
$$

- Error to the reference quasi-exact solution is second order in time but not of the same origin (splitting error vs. IMEX error) - but still error control
- Larger time step can be taken with IMEX while keeping a proper solution (no disastrous splitting errors - wrong wave speed)
- When optimal large splitting time step is taken, IMEX as efficient as splitting, whereas it is advantageous for smaller time steps as well as larger time steps
- No boundary condition problems
- Same computational good properties
::::

::::{.col-6 .text-center}

| | PIROCK (tol=5e-3) | STRANG (dt=2/128) |
|------------------------------|:------------------:|:--------------------:|
|L2 norm of error (variable b) | 3.31e-2 | 1.14e-1 |
|L2 norm of error (variable c) | 2.92e-3 | 1.37e-2 |
|Elapsed time (s) | 6.91 | 6.70 |
|Nb. time steps. | 624 | 128 |

&nbsp;

| | PIROCK (tol=1e-3) | STRANG (dt=2/512) |
|------------------------------|:------------------:|:--------------------:|
|L2 norm of error (variable b) | 4.94e-3 | 1.55e-3 |
|L2 norm of error (variable c) | 4.31e-4 | 1.41e-4 |
|Elapsed time (s) | 13.33 | 17.20 |
|Nb. time steps. | 1528 | 512 |

&nbsp;

| | PIROCK (tol=1e-4) | STRANG (dt=2/16384) |
|------------------------------|:------------------:|:--------------------:|
|L2 norm of error (variable b) | 7.72e-6 | 1.81e-5 |
|L2 norm of error (variable c) | 6.97e-7 | 1.57e-6 |
|Elapsed time (s) | 165.12 | 427.81 |
|Nb. time steps. | 31728 | 16384 |

::::
:::